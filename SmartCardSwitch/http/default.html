<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>SmartCardSwitch</title>
</head>
<body>

<h1>SmartCardSwitch Config Server</h1>

<div>
	<p> stepper0
	<div>
		<div>
			<label>MIN:</label><label id="stepper0MinHomeOffset"></label>
			<label>   Current:</label><label id="stepper0CurHomeOffset"></label>
			<label>   MAX:</label><label id="stepper0MaxHomeOffset"></label><br>
			<label>Steps:</label>
			<input type="number" id="stepper0Steps"></input>
			<button type="button" id="stepper0Decrease">-</button>
			<button type="button" id="stepper0Increase">+</button>
		</div>
		<div>
			<button type="button" id="stepper0Decrease32" onclick="onStepper0Decrease32()">-32</button>
			<button type="button" id="stepper0Decrease16">-16</button>
			<button type="button" id="stepper0Decrease8">-8</button>
			<button type="button" id="stepper0Decrease4">-4</button>
			<button type="button" id="stepper0Decrease1">-1</button>
			<button type="button" id="stepper0Increase1">+1</button>
			<button type="button" id="stepper0Increase4">+4</button>
			<button type="button" id="stepper0Increase8">+8</button>
			<button type="button" id="stepper0Increase16">+16</button>
			<button type="button" id="stepper0Increase32">+32</button>
		</div>
	</div>
	
	<div>
		<button type="button" id="stepper0Query">Query</button>
	</div>
</div>


<div>
	<p>bdc0
	<div>
		<input name="bdc0" id="bdc0Release" type="radio"><label for="bdc0Release">Release</label>
		<input name="bdc0" id="bdc0Open" type="radio"><label for="bdc0Open">Open</label>
		<input name="bdc0" id="bdc0Close" type="radio"><label for="bdc0Close">Close</label>
	</div>
</div>

<button onclick="myFunction()">Click Me!</button>
<script>
function myFunction() 
{
	var xhr = new XMLHttpRequest();
	xhr.open('GET', 'opt');

	// Track the state changes of the request.
	xhr.onreadystatechange = function () {
		var DONE = 4; // readyState 4 means the request is done.
		var OK = 200; // status 200 is a successful return.
		if (xhr.readyState === DONE) {
			if (xhr.status === OK) {
				console.log(xhr.responseText); // 'This is the output.'
			} else {
				console.log('Error: ' + xhr.status); // An error occurred during the request.
			}
		}
	};

	// Send the request to send-ajax-data.php
	xhr.send(null);
}

function moveStepper(stepper, forward, steps)
{
	var xhr = new XMLHttpRequest();
	xhr.responseType = "json";
	xhr.open('POST', 'stepperMove');
	
	xhr.onreadystatechange = function () {
		var DONE = 4; // readyState 4 means the request is done.
		var OK = 200; // status 200 is a successful return.
		if (xhr.readyState === DONE) {
			console.log("response is available");
			console.log("response type: " + xhr.responseType);

			if (xhr.status === OK) 
			{
				var jsonObj = xhr.response;
				var curHomeOffset = stepper + 'CurHomeOffset';

				console.log(JSON.stringify(jsonObj)); // 'This is the output.'

				document.getElementById(curHomeOffset).innerHTML = jsonObj[stepper]["homeOffset"].toString();

			} else {
				console.log('Error: ' + xhr.status); // An error occurred during the request.
			}
		}
	};
	
	var parameters = {};
	//stepper index
	if(stepper === "stepper0") {
		parameters["index"] = 0;
	}
	else if(stepper === "stepper1") {
		parameters["index"] = 1;
	}
	else if(stepper === "stepper2") {
		parameters["index"] = 2;
	}
	else if(stepper === "stepper3") {
		parameters["index"] = 3;
	}
	else {
		alert("Wrong stepper: " + stepper);
		return;
	}
	//direction
	if(forward == true) {
		parameters["forward"] = true;
	}
	else {
		parameters["forward"] = false;
	}
	parameters["steps"] = steps;
	
	xhr.send(JSON.stringify(parameters));
}

function queryStepper(stepper)
{
	var xhr = new XMLHttpRequest();
	xhr.responseType = "json";
	
	xhr.onreadystatechange = function () {
		var DONE = 4; // readyState 4 means the request is done.
		var OK = 200; // status 200 is a successful return.
		if (xhr.readyState === DONE) {
			if (xhr.status === OK) {
				console.log(xhr.responseText); // 'This is the output.'
			} else {
				console.log('Error: ' + xhr.status); // An error occurred during the request.
			}
		}
	};
	
}


function queryStepper(stepper)
{
	var xhr = new XMLHttpRequest();
	xhr.responseType = "json";
	
}

function onStepper0Decrease32() {
	moveStepper("stepper0", false, 32);
}
</script>

</body>
</html>
